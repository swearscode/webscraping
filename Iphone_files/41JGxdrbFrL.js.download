(function(v){var w=window.AmazonUIPageJS||window.P,n=w._namespace||w.attributeErrors,p=n?n("AmazonLightsaberPageAssets",""):w;p.guardFatal?p.guardFatal(v)(p,window):p.execute(function(){v(p,window)})})(function(v,w,n){(function(){var p;(function(e){e.deep=function(b){return JSON.parse(JSON.stringify(b))}})(p||(p={}));var x;(function(e){e.log=function(b){for(var a=1;a<arguments.length;a++);}})(x||(x={}));var H=this&&this.__awaiter||function(e,b,a,g){function c(b){return b instanceof a?b:new a(function(a){a(b)})}
return new (a||(a=Promise))(function(a,f){function d(b){try{l(g.next(b))}catch(m){f(m)}}function h(b){try{l(g["throw"](b))}catch(m){f(m)}}function l(b){b.done?a(b.value):c(b.value).then(d,h)}l((g=g.apply(e,b||[])).next())})},I=this&&this.__generator||function(e,b){function a(b){return function(a){return g([b,a])}}function g(a){if(h)throw new TypeError("Generator is already executing.");for(;c;)try{if(h=1,f&&(d=a[0]&2?f["return"]:a[0]?f["throw"]||((d=f["return"])&&d.call(f),0):f.next)&&!(d=d.call(f,
a[1])).done)return d;if(f=0,d)a=[a[0]&2,d.value];switch(a[0]){case 0:case 1:d=a;break;case 4:return c.label++,{value:a[1],done:!1};case 5:c.label++;f=a[1];a=[0];continue;case 7:a=c.ops.pop();c.trys.pop();continue;default:if(!(d=c.trys,d=0<d.length&&d[d.length-1])&&(6===a[0]||2===a[0])){c=0;continue}if(3===a[0]&&(!d||a[1]>d[0]&&a[1]<d[3]))c.label=a[1];else if(6===a[0]&&c.label<d[1])c.label=d[1],d=a;else if(d&&c.label<d[2])c.label=d[2],c.ops.push(a);else{d[2]&&c.ops.pop();c.trys.pop();continue}}a=b.call(e,
c)}catch(q){a=[6,q],f=0}finally{h=d=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}var c={label:0,sent:function(){if(d[0]&1)throw d[1];return d[1]},trys:[],ops:[]},h,f,d,k;return k={next:a(0),"throw":a(1),"return":a(2)},"function"===typeof Symbol&&(k[Symbol.iterator]=function(){return this}),k},z;(function(e){var b=this;e.getMatchingEntry=function(a){return H(b,void 0,void 0,function(){return I(this,function(b){return[2,new Promise(function(b,g){var c=new PerformanceObserver(function(c,
g){c=c.getEntries();for(var d=0;d<c.length;d++){var e=c[d];if(a(e)){g.disconnect();b(e);break}}});try{c.observe({type:"largest-contentful-paint",buffered:!0})}catch(d){try{c.disconnect()}catch(k){}g(d)}})]})})}})(z||(z={}));var r;(function(e){e.isObject=function(b){return!!b&&"object"===typeof b&&!Array.isArray(b)};e.isNonEmptyString=function(b){return"string"===typeof b&&0<b.length};e.isPositiveInteger=function(b){return"number"===typeof b&&Math.floor(b)===b&&0<=b&&Infinity!==b};e.isFunction=function(b){return"function"===
typeof b}})(r||(r={}));var C=this&&this.__awaiter||function(e,b,a,g){function c(b){return b instanceof a?b:new a(function(a){a(b)})}return new (a||(a=Promise))(function(a,f){function d(b){try{l(g.next(b))}catch(m){f(m)}}function h(b){try{l(g["throw"](b))}catch(m){f(m)}}function l(b){b.done?a(b.value):c(b.value).then(d,h)}l((g=g.apply(e,b||[])).next())})},D=this&&this.__generator||function(e,b){function a(b){return function(a){return g([b,a])}}function g(a){if(h)throw new TypeError("Generator is already executing.");
for(;c;)try{if(h=1,f&&(d=a[0]&2?f["return"]:a[0]?f["throw"]||((d=f["return"])&&d.call(f),0):f.next)&&!(d=d.call(f,a[1])).done)return d;if(f=0,d)a=[a[0]&2,d.value];switch(a[0]){case 0:case 1:d=a;break;case 4:return c.label++,{value:a[1],done:!1};case 5:c.label++;f=a[1];a=[0];continue;case 7:a=c.ops.pop();c.trys.pop();continue;default:if(!(d=c.trys,d=0<d.length&&d[d.length-1])&&(6===a[0]||2===a[0])){c=0;continue}if(3===a[0]&&(!d||a[1]>d[0]&&a[1]<d[3]))c.label=a[1];else if(6===a[0]&&c.label<d[1])c.label=
d[1],d=a;else if(d&&c.label<d[2])c.label=d[2],c.ops.push(a);else{d[2]&&c.ops.pop();c.trys.pop();continue}}a=b.call(e,c)}catch(q){a=[6,q],f=0}finally{h=d=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}var c={label:0,sent:function(){if(d[0]&1)throw d[1];return d[1]},trys:[],ops:[]},h,f,d,k;return k={next:a(0),"throw":a(1),"return":a(2)},"function"===typeof Symbol&&(k[Symbol.iterator]=function(){return this}),k},u;(function(e){var b=this;e.queueTask=function(a,b){return setTimeout(a,b||
0)};e.queueTaskEvery=function(a,b){return setInterval(a,b)};e.wait=function(a){return C(b,void 0,void 0,function(){return D(this,function(b){return[2,new Promise(function(b){setTimeout(b,a)})]})})};e.queueMicrotask=function(a){Promise.resolve().then(function(){a()})};e.waitTillIdleOrTimeout=function(a){return C(b,void 0,void 0,function(){return D(this,function(b){return[2,new Promise(function(b){self.requestIdleCallback?self.requestIdleCallback(function(a){b(a)},{timeout:a}):setTimeout(function(){b({didTimeout:!0,
timeRemaining:function(){return 0}})},a)})]})})}})(u||(u={}));var J=function(){function e(b){this._global=b;var a=r.isFunction;this._unsupported=!b.ue||!a(b.ue.tag)||!a(b.ue.count)||!a(b.uet)||!a(b.uex)}e.prototype.tag=function(b){this._unsupported||(b=this._getMetricName(b),this._global.ue.tag(b),this._global.ue.isl&&this._global.uex("at"),x.log("Lightsaber:Tag:",b))};e.prototype.count=function(b,a){void 0===a&&(a=1);this._unsupported||(b=this._getMetricName(b),this._global.ue.count(b,a),x.log("Lightsaber:Counter:",
b,a))};e.prototype.widgetLatency=function(b,a,g){a=this._getMetricName(a);"ld"===b?this._global.uex(b,a,{wb:1},g):this._global.uet(b,a,{wb:1},g)};e.prototype._getMetricName=function(b){return(e._METRIC_PREFIX+":"+b).toLowerCase()};e._METRIC_PREFIX="Lightsaber:Page";return e}(),K={"gateway-phone-apps":"HomePage","gateway-phone-web":"HomePage",Gateway:"HomePage",SearchAW:"Search",Search:"Search",DetailWebView:"Detail",WebflowDetailWebView:"Detail",DetailAW:"Detail",WebflowDetailAW:"Detail",Detail:"Detail",
WebflowDetail:"Detail",ShoppingCartWebview:"Cart",ShoppingCartAW:"Cart",ShoppingCart:"Cart",CheckoutConfirmOrderWebview:"Checkout",CheckoutConfirmOrderAW:"Checkout",CheckoutConfirmOrder:"Checkout"},t;(function(e){e.getPageType=function(b){return b.ue_pty||"unknown"};e.getSubPageType=function(b){return b.ue_spty||"unknown"};e.getRequestId=function(b){return b.ue_id};e.getPageTypeGroup=function(b){b=e.getPageType(b);return(b=K[b])?b:"Unknown"}})(t||(t={}));var y=function(){function e(b,a,g){this.global=
b;this._csmLogger=g;this._workerMessaging=a}e.prototype.getAbsoluteUrl=function(b){return(new URL(b,this.global.location.href)).href};e.prototype.ready=function(){return this._workerMessaging.ready()};e.prototype.sendToWorker=function(b){this._workerMessaging.send(e._RENDERING_HINTS_COMMAND,b)};e.prototype.logCount=function(b,a){this._csmLogger.count("RenderingHints:Collect:"+b,a)};e._RENDERING_HINTS_COMMAND="rendering_hints";return e}(),L=this&&this.__extends||function(){var e=function(b,a){e=Object.setPrototypeOf||
{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return e(b,a)};return function(b,a){function g(){this.constructor=b}e(b,a);b.prototype=null===a?Object.create(a):(g.prototype=a.prototype,new g)}}(),M=this&&this.__awaiter||function(e,b,a,g){function c(b){return b instanceof a?b:new a(function(a){a(b)})}return new (a||(a=Promise))(function(a,f){function d(a){try{l(g.next(a))}catch(m){f(m)}}function h(a){try{l(g["throw"](a))}catch(m){f(m)}}
function l(b){b.done?a(b.value):c(b.value).then(d,h)}l((g=g.apply(e,b||[])).next())})},N=this&&this.__generator||function(e,b){function a(a){return function(b){return g([a,b])}}function g(a){if(h)throw new TypeError("Generator is already executing.");for(;c;)try{if(h=1,f&&(d=a[0]&2?f["return"]:a[0]?f["throw"]||((d=f["return"])&&d.call(f),0):f.next)&&!(d=d.call(f,a[1])).done)return d;if(f=0,d)a=[a[0]&2,d.value];switch(a[0]){case 0:case 1:d=a;break;case 4:return c.label++,{value:a[1],done:!1};case 5:c.label++;
f=a[1];a=[0];continue;case 7:a=c.ops.pop();c.trys.pop();continue;default:if(!(d=c.trys,d=0<d.length&&d[d.length-1])&&(6===a[0]||2===a[0])){c=0;continue}if(3===a[0]&&(!d||a[1]>d[0]&&a[1]<d[3]))c.label=a[1];else if(6===a[0]&&c.label<d[1])c.label=d[1],d=a;else if(d&&c.label<d[2])c.label=d[2],c.ops.push(a);else{d[2]&&c.ops.pop();c.trys.pop();continue}}a=b.call(e,c)}catch(q){a=[6,q],f=0}finally{h=d=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}var c={label:0,sent:function(){if(d[0]&1)throw d[1];
return d[1]},trys:[],ops:[]},h,f,d,k;return k={next:a(0),"throw":a(1),"return":a(2)},"function"===typeof Symbol&&(k[Symbol.iterator]=function(){return this}),k},E=function(e){function b(a,b,c,h){b=e.call(this,a,b,c)||this;b._queryRoot=h||a.document;return b}L(b,e);b.prototype.trigger=function(){var a=this;u.queueTask(function(){return M(a,void 0,void 0,function(){var a;return N(this,function(c){switch(c.label){case 0:return[4,u.waitTillIdleOrTimeout(b._IDLE_TIMEOUT)];case 1:c.sent();if(!this.ready())return this.logCount("NotReady"),
[2];a=this.collect(this._queryRoot);this._send(a);return[2]}})})})};b.prototype._send=function(a){var g=this,c=Object.keys(a).map(function(c){return{nature:b._RENDERING_HINTS_NATURE,target:c,data:a[c],source:g._getSource()}});this.logCount("Targets",c.length);1>c.length||this.sendToWorker(c)};b.prototype._getSource=function(){return{url:this.global.location.href,pty:t.getPageType(this.global),spty:t.getSubPageType(this.global),rid:t.getRequestId(this.global)}};b._IDLE_TIMEOUT=1E3;b._RENDERING_HINTS_NATURE=
"speculated_navigation_content";return b}(y),O=this&&this.__extends||function(){var e=function(b,a){e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return e(b,a)};return function(b,a){function g(){this.constructor=b}e(b,a);b.prototype=null===a?Object.create(a):(g.prototype=a.prototype,new g)}}(),A=this&&this.__assign||function(){A=Object.assign||function(e){for(var b,a=1,g=arguments.length;a<g;a++){b=
arguments[a];for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&(e[c]=b[c])}return e};return A.apply(this,arguments)},B=function(e){function b(a,g,c,h,f,d){void 0===f&&(f=!1);void 0===d&&(d=b.POLLING_FREQUENCY);var k=e.call(this,a,g,c,h)||this;a.addEventListener(b.UPDATE_NOTIFICATION_EVENT,function(){k.trigger()});f&&u.queueTaskEvery(function(){k.trigger()},d);k.trigger();return k}O(b,e);b.update=function(a){var g=new CustomEvent(b.UPDATE_NOTIFICATION_EVENT,{bubbles:!1,cancelable:!1});a.dispatchEvent(g)};
b.prototype.collect=function(a){var g=a.querySelectorAll(b.QUERY_SELECTOR),c={};a=function(a){a=g[a];var d=A({},a.dataset),f=d[b.ATTR_TARGET];a.classList.remove(b.RENDERING_HINTS_CLASS);if(!f)return"continue";var h=e.getAbsoluteUrl(f);c[h]=c[h]||{};Object.keys(d).filter(function(a){return!!d[a]&&a!==b.ATTR_QUERY&&a!==b.ATTR_TARGET}).forEach(function(a){c[h][a]=d[a]})};for(var e=this,f=0;f<g.length;f++)a(f);return c};b.prototype.logCount=function(a,b){e.prototype.logCount.call(this,"DDHC:"+a,b)};b.RENDERING_HINTS_CLASS=
"lightsaber-rendering-hints";b.QUERY_SELECTOR='div[data-lightsaber\x3d"rendering-hints/speculated-navigation-content"].'+b.RENDERING_HINTS_CLASS;b.ATTR_QUERY="lightsaber";b.ATTR_TARGET="target";b.UPDATE_NOTIFICATION_EVENT="lightsaber:rendering-hints:declarative-dataset:update";b.POLLING_FREQUENCY=3E3;return b}(E),P=this&&this.__extends||function(){var e=function(b,a){e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&
(a[c]=b[c])};return e(b,a)};return function(b,a){function g(){this.constructor=b}e(b,a);b.prototype=null===a?Object.create(a):(g.prototype=a.prototype,new g)}}(),Q=function(e){function b(a,b,c,h,f,d){var g=e.call(this,a,b,c,d)||this;if(!f.capabilities.mobile)return g;h.when("Rush","s-web-application-controller").execute(function(b,c){b.on(c.ACTIONS.LOAD_SEARCH_PAGE_COMPLETE,function(){g.trigger();B.update(a)})});g._previouslySeenTargets={};g.trigger();return g}P(b,e);b.prototype.collect=function(a){a=
a.querySelectorAll(b.FACEOUT_IMAGE_QUERY);for(var e={},c=0;c<a.length;c++){var h=a[c],f=h.closest("a");f&&(f=f.href,this._previouslySeenTargets[f]||(this._previouslySeenTargets[f]=!0,e[f]={faceoutImage:h.src,productTitle:h.alt}))}this.logCount("Query",Object.keys(e).length);return e};b.prototype.logCount=function(a,b){e.prototype.logCount.call(this,"SPHC:"+a,b)};b.FACEOUT_IMAGE_QUERY='a.s-faceout-link img.s-image[data-image-latency\x3d"s-product-image"]';return b}(E),R=this&&this.__extends||function(){var e=
function(b,a){e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return e(b,a)};return function(b,a){function g(){this.constructor=b}e(b,a);b.prototype=null===a?Object.create(a):(g.prototype=a.prototype,new g)}}(),S=this&&this.__awaiter||function(e,b,a,g){function c(b){return b instanceof a?b:new a(function(a){a(b)})}return new (a||(a=Promise))(function(a,f){function d(a){try{l(g.next(a))}catch(m){f(m)}}
function h(a){try{l(g["throw"](a))}catch(m){f(m)}}function l(b){b.done?a(b.value):c(b.value).then(d,h)}l((g=g.apply(e,b||[])).next())})},T=this&&this.__generator||function(e,b){function a(a){return function(b){return g([a,b])}}function g(a){if(h)throw new TypeError("Generator is already executing.");for(;c;)try{if(h=1,f&&(d=a[0]&2?f["return"]:a[0]?f["throw"]||((d=f["return"])&&d.call(f),0):f.next)&&!(d=d.call(f,a[1])).done)return d;if(f=0,d)a=[a[0]&2,d.value];switch(a[0]){case 0:case 1:d=a;break;
case 4:return c.label++,{value:a[1],done:!1};case 5:c.label++;f=a[1];a=[0];continue;case 7:a=c.ops.pop();c.trys.pop();continue;default:if(!(d=c.trys,d=0<d.length&&d[d.length-1])&&(6===a[0]||2===a[0])){c=0;continue}if(3===a[0]&&(!d||a[1]>d[0]&&a[1]<d[3]))c.label=a[1];else if(6===a[0]&&c.label<d[1])c.label=d[1],d=a;else if(d&&c.label<d[2])c.label=d[2],c.ops.push(a);else{d[2]&&c.ops.pop();c.trys.pop();continue}}a=b.call(e,c)}catch(q){a=[6,q],f=0}finally{h=d=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:
void 0,done:!0}}var c={label:0,sent:function(){if(d[0]&1)throw d[1];return d[1]},trys:[],ops:[]},h,f,d,k;return k={next:a(0),"throw":a(1),"return":a(2)},"function"===typeof Symbol&&(k[Symbol.iterator]=function(){return this}),k};y=function(e){function b(a,b,c,h){a=e.call(this,a,b,c)||this;a._queryRoot=h;return a}R(b,e);b.prototype.trigger=function(){var a=this;u.queueTask(function(){return S(a,void 0,void 0,function(){var a;return T(this,function(c){switch(c.label){case 0:return[4,u.waitTillIdleOrTimeout(b._IDLE_TIMEOUT)];
case 1:return c.sent(),this.ready()?[4,this.collect(this._queryRoot)]:(this.logCount("NotReady"),[2]);case 2:return a=c.sent(),this._send(a),[2]}})})})};b.prototype.logCount=function(a,b){e.prototype.logCount.call(this,"PAHC:"+a,b)};b.prototype._send=function(a){a=[{nature:b._RENDERING_HINTS_NATURE,data:a,source:this._getSource()}];this.logCount("Targets");this.sendToWorker(a)};b.prototype._getSource=function(){return{url:this.global.location.href,pty:t.getPageType(this.global),spty:t.getSubPageType(this.global),
rid:t.getRequestId(this.global)}};b._IDLE_TIMEOUT=1E3;b._RENDERING_HINTS_NATURE="page_attributes";return b}(y);var U=this&&this.__extends||function(){var e=function(b,a){e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return e(b,a)};return function(b,a){function g(){this.constructor=b}e(b,a);b.prototype=null===a?Object.create(a):(g.prototype=a.prototype,new g)}}(),F=this&&this.__awaiter||function(e,
b,a,g){function c(b){return b instanceof a?b:new a(function(a){a(b)})}return new (a||(a=Promise))(function(a,f){function d(a){try{l(g.next(a))}catch(m){f(m)}}function h(a){try{l(g["throw"](a))}catch(m){f(m)}}function l(b){b.done?a(b.value):c(b.value).then(d,h)}l((g=g.apply(e,b||[])).next())})},G=this&&this.__generator||function(e,b){function a(a){return function(b){return g([a,b])}}function g(a){if(h)throw new TypeError("Generator is already executing.");for(;c;)try{if(h=1,f&&(d=a[0]&2?f["return"]:
a[0]?f["throw"]||((d=f["return"])&&d.call(f),0):f.next)&&!(d=d.call(f,a[1])).done)return d;if(f=0,d)a=[a[0]&2,d.value];switch(a[0]){case 0:case 1:d=a;break;case 4:return c.label++,{value:a[1],done:!1};case 5:c.label++;f=a[1];a=[0];continue;case 7:a=c.ops.pop();c.trys.pop();continue;default:if(!(d=c.trys,d=0<d.length&&d[d.length-1])&&(6===a[0]||2===a[0])){c=0;continue}if(3===a[0]&&(!d||a[1]>d[0]&&a[1]<d[3]))c.label=a[1];else if(6===a[0]&&c.label<d[1])c.label=d[1],d=a;else if(d&&c.label<d[2])c.label=
d[2],c.ops.push(a);else{d[2]&&c.ops.pop();c.trys.pop();continue}}a=b.call(e,c)}catch(q){a=[6,q],f=0}finally{h=d=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}var c={label:0,sent:function(){if(d[0]&1)throw d[1];return d[1]},trys:[],ops:[]},h,f,d,k;return k={next:a(0),"throw":a(1),"return":a(2)},"function"===typeof Symbol&&(k[Symbol.iterator]=function(){return this}),k};(function(e){function b(a,b,c,h){a=e.call(this,a,b,c,a.document)||this;if(!h.capabilities.mobile)return a;a.trigger();
return a}U(b,e);b.prototype.collect=function(a){return F(this,void 0,void 0,function(){var b,c,e;return G(this,function(g){switch(g.label){case 0:return b={},(c=this._getWDGFromUSS(a))||(c=this._getWDGFromAODScript(a)),c||(c=this._getWDGFromDPContainer(a)),c?b.wdg=c:this.logCount("WDG:NONE"),[4,this._getLCPImageUrl()];case 1:if(e=g.sent())b.lcpImage=e;return[2,b]}})})};b.prototype._getWDGFromUSS=function(a){if((a=a.querySelector(b._USS_SELECTOR))&&a.value)return this.logCount("WDG:USS"),a.value};
b.prototype._getWDGFromAODScript=function(a){if((a=a.querySelector(b._AOD_SCRIPT_SELECTOR))&&(a=a.textContent)&&(a=a.match(b._AOD_SCRIPT_REGEXP))&&a[1])return this.logCount("WDG:AOD"),a[1]};b.prototype._getWDGFromDPContainer=function(a){if(a=a.querySelector(b._DP_CONTAINER_SELECTOR))if(a=a.className.trim().split(" ")[0])return this.logCount("WDG:CID"),a.replace(b._WDG_CLASS_SUFFIX,b._WDG_SUFFIX)};b.prototype._getLCPImageUrl=function(){return F(this,void 0,void 0,function(){var a,e;return G(this,function(c){switch(c.label){case 0:a=
function(a){var c=r.isObject,d=r.isNonEmptyString;return!(!c(a)||a.id!==b._IMAGE_BLOCK_MAIN_IMAGE_ID||!d(a.url))},c.label=1;case 1:return c.trys.push([1,3,,4]),[4,Promise.race([z.getMatchingEntry(a),u.wait(b._LCP_RESOLUTION_TIMEOUT)])];case 2:return e=c.sent(),this.logCount("LCPI"),[2,e?e.url:n];case 3:return c.sent(),this.logCount("LCPE"),[2];case 4:return[2]}})})};b._DP_CONTAINER_SELECTOR="#dp";b._USS_SELECTOR="input#uss-mraiCategory";b._AOD_SCRIPT_SELECTOR="#all-offers-display ~ script";b._AOD_SCRIPT_REGEXP=
/AOD assets for WDG:\s*(\w+)/;b._IMAGE_BLOCK_MAIN_IMAGE_ID="main-image";b._LCP_RESOLUTION_TIMEOUT=1E3;b._WDG_CLASS_SUFFIX="_mobile";b._WDG_SUFFIX="_display_on_website";return b})(y);y=function(){function e(b,a,e,c){var g=this;this.global=b;this.csmLogger=a;this.P=e;this.A=c;"complete"===b.document.readyState?this.survey():b.addEventListener("load",function(){g.survey()})}e.prototype.getResourceTimingRecords=function(b){var a=this.global.performance.getEntriesByType("resource");return"function"===
typeof b?a.filter(b):a};e.prototype.getServerTimingRecords=function(){var b=this.global.performance.getEntriesByType("navigation")[0];return b&&b.serverTiming?b.serverTiming.filter(function(a){return a.name===e._SERVER_TIMING_NAME}).map(function(a){if(a.description)try{return JSON.parse(decodeURIComponent(a.description))}catch(g){}}).filter(function(a){return!!a}):[]};e.prototype.getEpochForPerformanceTimeline=function(b){return Math.round(this.global.performance.timeOrigin+b)};e.prototype.logTag=
function(b){this.csmLogger.tag(this._getMetricName(b))};e.prototype.logCount=function(b,a){this.csmLogger.count(this._getMetricName(b),a)};e.prototype.logWidgetLatency=function(b,a,e){a=this._getMetricName(a);this.csmLogger.widgetLatency(b,a,e)};e.prototype._getMetricName=function(b){return"RenderingHints:Survey:"+b};e._SERVER_TIMING_NAME="lightsaber";return e}();var V=this&&this.__extends||function(){var e=function(b,a){e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=
b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return e(b,a)};return function(b,a){function g(){this.constructor=b}e(b,a);b.prototype=null===a?Object.create(a):(g.prototype=a.prototype,new g)}}(),W=function(e){function b(){return null!==e&&e.apply(this,arguments)||this}V(b,e);b.prototype.survey=function(){var a=this._getLandingImageUrl();if(a){var b=this._getPreloadedUrlRecord();b?this._logMatch(a,b.href,b.attribution):this._logCount("HintNotFound",1)}else this._logCount("NoLandingImage",
1)};b.prototype._getLandingImageUrl=function(){var a=this.A.state(this.A.capabilities.mobile?b._MOBILE_PAGE_STATE:b._DESKTOP_PAGE_STATE);return a&&a.landingImageUrl?a.landingImageUrl:n};b.prototype._getPreloadedUrlRecord=function(){var a=this.getServerTimingRecords().filter(function(a){return a.role===b._RECORD_ROLE&&a.purpose===b._RECORD_PURPOSE&&a.as===b._RECORD_AS});return 0<a.length?a[0]:n};b.prototype._logMatch=function(a,b,c){a=this._hitOrMiss(b===a);this._logCount(a,1);c&&this._logCount(a+
":"+c,1)};b.prototype._logCount=function(a,e){this.logCount(b._METRIC_PREFIX+":"+a,e)};b.prototype._hitOrMiss=function(a){return a?"Hit":"Miss"};b._RECORD_ROLE="rendering-hints/preload";b._RECORD_PURPOSE="detail-landing-image";b._RECORD_AS="image";b._METRIC_PREFIX="DetailLandingImagePreload";b._MOBILE_PAGE_STATE="mobile-landing-image-data";b._DESKTOP_PAGE_STATE="desktop-landing-image-data";return b}(y),X=function(){function e(b,a,e,c,h){this._global=b;this._P=a;this._A=e;this._workerMessaging=c;this._csmLogger=
h}e.prototype.start=function(){switch(t.getPageTypeGroup(this._global)){case "Search":var b=document.getElementById("search");new B(this._global,this._workerMessaging,this._csmLogger,b);new Q(this._global,this._workerMessaging,this._csmLogger,this._P,this._A,b);break;case "Detail":b=document.getElementById("dp"),new B(this._global,this._workerMessaging,this._csmLogger,b),new W(this._global,this._csmLogger,this._P,this._A)}};return e}();(function(){function e(b){this._hit=!(!b.$Lightsaber||!b.$Lightsaber.hit);
try{var a=b.$Lightsaber&&b.$Lightsaber.meta?p.deep(b.$Lightsaber.meta):n;this._meta=this._isValid(a)?a:n}catch(g){this._meta=n}}e.prototype.isHit=function(){return this._hit};e.prototype.getMeta=function(){return this._meta};e.prototype._isValid=function(b){var a=r.isObject,e=r.isNonEmptyString,c=r.isPositiveInteger;return!!(b&&a(b)&&c(b.fetchEventTimeOrigin)&&e(b.navigationRule)&&a(b.responseStrategy)&&e(b.responseStrategy.name)&&a(b.clientLib)&&e(b.clientLib.version))};return e})();var Y=function(){function e(b){this._global=
b}e.prototype.send=function(b,a){b={feature:e.FEATURE,command:b,options:a};(a=this._getCurrentController())?(x.log("ServiceWorker:PostMessage:",b),a.postMessage(b)):x.log("ServiceWorker:Unavailable:",b)};e.prototype.ready=function(){return!!this._getCurrentController()};e.prototype._getCurrentController=function(){if(this._global&&this._global.navigator&&this._global.navigator.serviceWorker&&this._global.navigator.serviceWorker.controller&&r.isFunction(this._global.navigator.serviceWorker.controller.postMessage))return this._global.navigator.serviceWorker.controller};
e.FEATURE="lightsaber";return e}();(function(){v.when("A").execute("lightsaber:page",function(e){var b=new J(w),a=new Y(w);b.count("AssetLoaded");v.now().register("lightsaber:page:rendering-metrics",function(){});v.when("ready").register("lightsaber:page:rendering-hints",function(){(new X(w,v,e,a,b)).start()})})})()})()});